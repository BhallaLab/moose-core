language: cpp
dist: trusty
sudo: required 
compiler:
    - gcc
    - clang
os:
    - linux
notifications:
    email:
        recipients:
            - dilawar.s.rajput@gmail.com
        on_success: change
        on_failure: always

env:
    - CTEST_MODEL=Nightly
cache: apt

matrix:
    allow_failures:
        os: osx
    include:
        - os : linux
          dist : trusty
          sudo : required 
        - os : osx
          osx_image : xcode8.1

before_script : 
    - echo "OSX related"
    - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then ./scripts/travis_prepare_osx.sh; fi
    - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo ./scripts/travis_prepare_linux.sh; fi

install:
    - echo "nothing to do here"

script:
    - # checking if any python3 incompatible file is in the source tree.
    - python2 -m compileall -q .
    - if type python3 -c 'import sys' > /dev/null; then python3 -m compileall -q . ; fi
    #- if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then ./.travis/travis_build_osx.sh; fi
    - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then ./.travis/travis_build_linux.sh; fi
